"use strict";
jQuery(function($){


    /**
        Diabled Add To Cart Button
    **/
    var cart_btn_hide = ppom_enf_vars.cart_btn_hide;

    if (cart_btn_hide == 'yes') {
        $('form.cart button[type="submit"]').hide();
    }


    /**
        Submit Porduct Enquiry Form
    **/
    $(document).on('click', '#ppom-enf-submit-meta', function(e) {
        e.preventDefault();

        var has_error     = false;        
        var user_email    = jQuery('#ppom_enf_user_email').val();
        var user_message  = jQuery('#ppom_enf_user_message').val();
        var enf_nonce     = jQuery('#ppom_enf_nonce_create').val();
        var product_id    = jQuery('#ppom_product_id').val();
        var ppom_meta     = jQuery('form.cart').serialize();

        // Form validations
        if (user_email == ''){
            jQuery(".ppom-enf-alert").html('Email Field Required').css('border-left','7px solid red').show();
            has_error = true;
        }else if(user_message == ''){
            jQuery(".ppom-enf-alert").html('Message Field Required').css('border-left','7px solid red').show();
            has_error = true;
        }else{
            jQuery(".ppom-enf-alert").html('<img src="' + ppom_enf_vars.loading + '">').css('border-left','none').show();
        }
        
        if (!has_error){
            var data = {    
                        'action': 'ppom_enf_ajax', 
                        'ppom_enf_nonce': enf_nonce, 
                        'user_email': user_email,
                        'user_message': user_message,
                        'product_id': product_id,
                        'ppom_meta': ppom_meta
                       };
                       
            $.post(ppom_enf_vars.ajax_url, data, function(resp) {
                
                jQuery('.ppom-enf-wrap').find('.ppom-enf-alert').hide();
                if (resp.status == 'success') {
                    jQuery('.ppom-enf-wrap').find('.ppom-enf-alert').html(resp.message).css('border-left','7px solid green').show();
                }else{
                    jQuery('.ppom-enf-wrap').find('.ppom-enf-alert').html(resp.message).css('border-left','7px solid red').show();
                }

            }, 'json');
        }
    });

});