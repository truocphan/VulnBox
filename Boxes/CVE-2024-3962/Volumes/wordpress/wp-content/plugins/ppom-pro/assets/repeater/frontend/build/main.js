!function(){"use strict";const a=(a,e,t)=>{t(ppom_input_vars.field_meta.map((t=>{const n=ppom_input_vars.product_id;switch(a.find(`.ppom-field-wrapper.${t.data_name}`).attr("data-data_name",`${t.data_name}__clone_${e}`).removeClass(t.data_name).removeClass(`ppom-wrapper_outer-${t.data_name}`).addClass(`${t.data_name}__clone_${e}`).addClass(`ppom-wrapper_outer-${t.data_name}__clone_${e}`),t.type){case"checkbox":jQuery.each(t.options,(function(o,_){var d=`.${t.data_name}.ppom-option-${_.id}`,i=`${n}-${t.data_name}_${e}-${_.id}`,p=`ppom[fields][${t.data_name}__clone_${e}][]`;a.find(`${d}`).attr("id",i).attr("name",p).attr("data-data_name",`${t.data_name}__clone_${e}`).closest("label").attr("for",i)}));break;case"file":var o=`.ppom-input.${t.data_name}`,_=`selectfiles-${t.data_name}__clone_${e}`,d=`.ppom-input-${t.data_name}`,i=`ppom-file-container-${t.data_name}__clone_${e}`,p=`.filelist.${t.data_name}`,r=`filelist-${t.data_name}__clone_${e}`;a.find(`${o}`).attr("id",_),a.find(`${d}`).attr("id",i),a.find(`${p}`).attr("id",r).html("");break;case"selectqty":var l=`.ppom-input.${t.data_name}`,c=`${t.data_name}_${e}`,m=`ppom[fields][${t.data_name}__clone_${e}][option]`;a.find(`${l}`).attr("id",c).attr("name",m).attr("data-data_name",`${t.data_name}__clone_${e}`);var s=`.ppom-quantity.${t.data_name}`,f=`${t.data_name}_${e}-qty`,u=`ppom[fields][${t.data_name}__clone_${e}][qty]`;a.find(`${s}`).attr("id",f).attr("name",u).attr("data-data_name",`${t.data_name}__clone_${e}`);break;default:o=`.ppom-input.${t.data_name}`,_=`${t.data_name}_${e}`;var v=`ppom[fields][${t.data_name}__clone_${e}]`;a.find(`${o}`).attr("id",_).attr("name",v).siblings("label").attr("for",_).closest("label").attr("for",_),"color"===t.type&&cloned_fields.find('div[data-type="color"]').map(((a,e)=>{$(e).find(".iris-picker").remove()}))}return{...t,data_name:`${t.data_name}__clone_${e}`,org_data_name:t.data_name}})))};jQuery((function(e){var t={cloned_counter:0,init:function(){this.handle_click_clone(),this.handle_click_remove(),this.catch_file_upload_event()},handle_click_clone:function(){jQuery(document).on("click",".ppom-repeater-clone",(function(n){n.preventDefault(),++t.cloned_counter;const o=e(this).closest(".ppom-repeater-wrapper");t.clone_fields(o,(function(n){a(n,t.cloned_counter,(function(a){t.apply_conditions(a),t.init_input_js(a),ppom_update_option_prices()})),e(".ppom-rendering-fields").trigger("ppom_repeated",[n])}))}))},handle_click_remove:function(){jQuery(document).on("click",".ppom-repeater-remove",(function(a){a.preventDefault(),e(this).closest(".ppom-repeater-wrapper").remove(),ppom_update_option_prices()}))},catch_file_upload_event(){e(document).on("ppom_file_uploaded",(function(a){if(void 0===a.file_meta.org_data_name)return;const t=a.file_meta.org_data_name,n=e(`#ppom-file-container-${a.file_meta.data_name}`).closest(".ppom-repeater-wrapper").data("repeater-id");e(`.ppom-file-cb-${a.file_meta.data_name}`).map(((o,_)=>{const d=`ppom[fields][${t}__clone_${n}][${a.file.id}][org]`;e(_).attr("name",d)}))}))},clone_fields:function(a,n){const o=e(".ppom-rendering-fields");n(a.clone().attr("data-repeater-id",t.cloned_counter).appendTo(o))},init_input_js(a){e.each(a,(function(e,t){var n=jQuery("#"+t.data_name);switch(t.type){case"date":if("on"===t.jquery_dp){if(n.removeClass("hasDatepicker").removeData("datepicker").unbind(),n.datepicker({changeMonth:!0,changeYear:!0,dateFormat:t.date_formats.ppom_js_stripSlashes(),yearRange:t.year_range}),void 0!==t.past_dates&&t.past_dates.length>0){var o=t.past_dates.trim();"on"===o&&(o=new Date),n.datepicker("option","minDate",o)}"on"===t.no_weekends&&n.datepicker("option","beforeShowDay",jQuery.datepicker.noWeekends)}break;case"color":n.css("background-color",t.default_color);var _={palettes:ppom_get_palette_setting(t),hide:"on"!=t.show_onload,color:t.default_color,mode:""!=t.palettes_mode?t.palettes_mode:"hsv",width:""!=t.palettes_width?t.palettes_width:200,change:function(a,e){n.css("background-color",e.color.toString()),n.css("color","#fff"),n.val(e.color.toString())}};n.iris(_),n.iris("hide");break;case"file":a.filter((a=>"file"==a.type)).map((a=>ppom_setup_file_upload_input(a)))}}))},apply_conditions(a){const t={...ppom_input_vars.conditions};Object.keys(t).map(((n,o)=>{a.map((o=>{if(o.org_data_name===n){var _=e(`.ppom-field-wrapper.${o.data_name}`);_.attr("data-cond-total",t[n].rules.length).attr("data-cond-bind",t[n].bound).attr("data-cond-visibility",t[n].visibility),t[n].rules.map(((e,t)=>{var n=a.find((a=>a.org_data_name===e.elements));_.removeClass(`ppom-cond-${e.elements}`).addClass(`ppom-cond-${n.data_name}`).removeClass(`ppom-locked-${e.elements}`).addClass(`ppom-locked-${n.data_name}`).attr("data-cond-input"+ ++t,n.data_name)}))}}))}))}};t.init()}))}();