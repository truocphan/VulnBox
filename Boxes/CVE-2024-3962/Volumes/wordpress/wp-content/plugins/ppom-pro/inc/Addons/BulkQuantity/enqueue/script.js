jQuery(function($) {

    $('.ppom-table-customizer tbody tr:last').find('td:last input').prop('checked', true).trigger('change');

    $(".ppom-inner-box").click(function() {
        $(this).find('input:radio').attr('checked', true).trigger('change');
    });


    var cell_index = {};

    $('.ppom-qty-js').on('change', function(e) {

        e.preventDefault();

        var vlabel = $(this).attr('data-vlabel');
        var vq = $(this).attr('data-vquantity');

        var checked = $(this).is(':checked');
        var closest_td = $(this).closest('td');
        var closest_tbody = $(this).closest('tbody');

        var first_tr = closest_tbody.find('tr:first');
        first_tr.find('.ppom_row_' + vlabel).find('input').attr('data-head-qty', vq);

        $('.ppom-column-js').removeClass('active-colunm');

        var tdIndex = $(this).closest("td").index();

        cell_index.index = tdIndex;

        // Reset
        $('.ppom-table-customizer tr td').css({
            'background': '',
            'border-color': '',
            'color': ''
        });

        if (checked) {
            $('.ppom_row_' + vlabel).css({
                'background': '#ccc',
                'border-color': '#ccc',
                'color': 'black'
            });
            $('.ppom_colunm_' + vq).css({
                'background': '#ccc',
                'border-color': '#ccc',
                'color': 'black'
            }).addClass('active-colunm');

            closest_td.css({
                'background': '#2195f2',
                'border-color': '#2195f2',
                'color': '#fff'
            });
        }



        $('.ppom-bulkquantity-qty').val(vq).trigger('change');
        $('.ppom-bulkquantity-options').val(vlabel).trigger('change');



    });

    $('.ppom-row-js').on('click', function(e) {

        e.preventDefault();

        var trIndex = $(this).closest("td").index();

        console.log(trIndex);

        $('.ppom-inner-box, .ppom-row-js').css({
            'background': '',
            'border-color': '',
            'color': ''
        });

        $('.active-colunm').parent().find('td:eq(' + trIndex + ')').find('input').prop('checked', true).trigger('change');

        $('.active-colunm').parent().find('td:eq(' + trIndex + ')').css({
            'background': '#2195f2',
            'border-color': '#2195f2',
            'color': '#fff'
        });

        $(this).css({
            'background': '#ccc',
            'border-color': '#css',
            'color': 'black'
        });

    });

    $('.ppom-column-js').on('click', function(e) {

        e.preventDefault();

        var tr = $(this).closest("tr");
        // tr.find()

        console.log(cell_index);

        $('.ppom-inner-box, .ppom-column-js').css({
            'background': '',
            'border-color': '',
            'color': ''
        });

        tr.find('td:eq(' + cell_index.index + ')').find('input').prop('checked', true).trigger('change');

        tr.find('td:eq(' + cell_index.index + ')').css({
            'background': '#2195f2',
            'border-color': '#2195f2',
            'color': '#fff'
        });

        $(this).css({
            'background': '#ccc',
            'border-color': '#css',
            'color': 'black'
        });


    });
});
