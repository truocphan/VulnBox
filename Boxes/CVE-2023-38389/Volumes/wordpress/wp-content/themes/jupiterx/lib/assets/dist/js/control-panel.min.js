"use strict";var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(d,t){var n=(_createClass(e,[{key:"events",value:function(){function i(){d('[data-toggle="tooltip"]').tooltip(),d('[data-toggle="popover"]').click(function(t){t.preventDefault()}),d('[data-toggle="popover"]').popover({trigger:"focus",container:".jupiterx.jupiterx-modal",html:!0})}d(".jupiterx-setup-wizard-hide-notice").on("click",function(t){t.preventDefault(),d(this).attr("disabled","disabled"),d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"jupiterx_setup_wizard_hide_notice"},beforeSend:function(){d(".jupiterx-setup-wizard-message").fadeOut(400)}})}),d(document).off().on("click","#jupiterx-api-key-switch",function(t){t.preventDefault();var e=d(this),n=d("#jupiterx-modal");"api"===e.data("activation-mode")?(n.find(".jupiterx-purchase-code-mode-element").addClass("d-block").removeClass("d-none"),n.find(".jupiterx-api-mode-element").addClass("d-none").removeClass("d-block d-flex"),n.find("#jupiterx-cp-gdpr-option-wrapper, #jupiterx-cp-mailing-list-option-wrapper").addClass("d-flex").removeClass("d-none"),e.data("activation-mode","purchase-code"),e.text(jupiterx_cp_textdomain.license_manager_add_api)):(n.find(".jupiterx-api-mode-element").addClass("d-block").removeClass("d-none"),n.find(".jupiterx-purchase-code-mode-element").addClass("d-none").removeClass("d-block d-flex"),e.data("activation-mode","api"),e.text(jupiterx_cp_textdomain.license_manager_insert_purchase_code)),i()}),d("#js__regiser-api-key-btn").on("click",function(t){var e;t.preventDefault(),jupiterx_modal((_defineProperty(e={title:jupiterx_cp_textdomain.registering_theme,type:"",cancelButtonText:jupiterx_cp_textdomain.discard,showCancelButton:!0,showConfirmButton:!0,showCloseButton:!0,confirmButtonText:jupiterx_cp_textdomain.submit},"cancelButtonText",jupiterx_cp_textdomain.cancel),_defineProperty(e,"closeOnConfirm",!1),_defineProperty(e,"text",d(wp.template("jupiterx-cp-registration")())),_defineProperty(e,"onConfirm",function(){if("api"===d("#jupiterx-api-key-switch").data("activation-mode")){var t=d("#jupiterx-cp-register-api-input").val();if(0===t.length)return!1;var e={action:"jupiterx_cp_register_revoke_api_action",method:"register",api_key:t,security:d("#security").val()};jupiterx_modal({type:"",title:jupiterx_cp_textdomain.license_manager_registration_title,text:jupiterx_cp_textdomain.wait_for_api_key_registered,cancelButtonText:jupiterx_cp_textdomain.discard,showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,indefiniteProgress:!0,progress:"100%"}),d.post(_wpUtilSettings.ajax.url,e,function(t){!0===(t=JSON.parse(t)).status&&(t.data||{}).status?(jupiterx_modal({title:jupiterx_cp_textdomain.thanks_registering,text:t.message,type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!0,closeOnOutsideClick:!1,closeOnConfirm:!1,onConfirm:function(){window.location.reload()}}),d(".jupiterx-wrap").removeClass("jupiterx-call-to-register-product"),d(".get-api-key-form").addClass("d-none"),d(".remove-api-key-form").removeClass("d-none")):jupiterx_modal({title:jupiterx_cp_textdomain.registeration_unsuccessful,text:t.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){d("#jupiterx-cp-register-api-input").val("")}})})}else{var i=d("#jupiterx-cp-register-purchase-code-input").val(),n=d("#jupiterx-cp-register-email").val();if(0===i.length||0===n.length)return!1;if(!d("#jupiterx-cp-register-gdpr").prop("checked"))return d("#jupiterx-cp-register-gdpr").addClass("is-invalid"),!1;d("#jupiterx-cp-register-gdpr").removeClass("is-invalid");var o={action:"jupiterx_register_license",purchase_code:i,nonce:d("#license-manager-nonce").val(),email:d("#jupiterx-cp-register-email").val(),accept_mail_list:d("#jupiterx-cp-register-mailing-list").prop("checked")?"on":"off"};jupiterx_modal({type:"",title:jupiterx_cp_textdomain.license_manager_registration_title,text:jupiterx_cp_textdomain.wait_for_api_key_registered,cancelButtonText:jupiterx_cp_textdomain.discard,showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,indefiniteProgress:!0,progress:"100%"}),d.post(_wpUtilSettings.ajax.url,o,function(t){if("valid_api"===t.data.code){console.log("Validating API key ...");var e={action:"jupiterx_cp_register_revoke_api_action",method:"register",api_key:i,security:d("#security").val()};d.post(_wpUtilSettings.ajax.url,e,function(t){!0===(t=JSON.parse(t)).status&&(t.data||{}).status?(jupiterx_modal({title:jupiterx_cp_textdomain.thanks_registering,text:t.message,type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!0,closeOnOutsideClick:!1,closeOnConfirm:!1,onConfirm:function(){window.location.reload()}}),d(".jupiterx-wrap").removeClass("jupiterx-call-to-register-product"),d(".get-api-key-form").addClass("d-none"),d(".remove-api-key-form").removeClass("d-none")):jupiterx_modal({title:jupiterx_cp_textdomain.registeration_unsuccessful,text:t.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){d("#jupiterx-cp-register-api-input").val("")}})})}else if(!0===t.success){var n=t.data||{};n.status?(jupiterx_modal({title:jupiterx_cp_textdomain.thanks_registering,text:n.message,type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!0,closeOnOutsideClick:!1,closeOnConfirm:!1,onConfirm:function(){window.location.reload()}}),d(".jupiterx-wrap").removeClass("jupiterx-call-to-register-product"),d(".get-api-key-form").addClass("d-none"),d(".remove-api-key-form").removeClass("d-none")):jupiterx_modal({title:jupiterx_cp_textdomain.registeration_unsuccessful,text:t.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){d("#jupiterx-cp-register-api-input").val(""),window.location.reload()}})}else jupiterx_modal({title:jupiterx_cp_textdomain.registeration_unsuccessful,text:t.data.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){d("#jupiterx-cp-register-api-input").val("")}})})}}),e)),i()}),d("#js__revoke-api-key-btn").on("click",function(t){t.preventDefault();var e=d(this).data("revoking-mode")||"api";jupiterx_modal({title:jupiterx_cp_textdomain.revoke_API_key,text:jupiterx_cp_textdomain.you_are_about_to_remove_API_key,type:"warning",showCancelButton:!0,showConfirmButton:!0,showLearnmoreButton:!1,confirmButtonText:jupiterx_cp_textdomain.ok,cancelButtonText:jupiterx_cp_textdomain.cancel,closeOnConfirm:!1,onConfirm:function(){if("api"===e){var t={action:"jupiterx_cp_register_revoke_api_action",method:"revoke",security:d("#security").val()};d.post(_wpUtilSettings.ajax.url,t,function(t){!0===(t=JSON.parse(t)).status&&window.location.reload()})}else t={action:"jupiterx_revoke_license",nonce:d("#license-manager-nonce").val()},jupiterx_modal({type:"",title:jupiterx_cp_textdomain.license_manager_revoking_title,text:jupiterx_cp_textdomain.wait_for_api_key_revoke,cancelButtonText:jupiterx_cp_textdomain.discard,showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,indefiniteProgress:!0,progress:"100%"}),d.post(_wpUtilSettings.ajax.url,t,function(t){!0===t.success?window.location.reload():jupiterx_modal({title:jupiterx_cp_textdomain.license_manager_revoking_error,text:t.data.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){window.location.reload()}})})}})})}}]),e);function e(){_classCallCheck(this,e),this.events()}var i=(_createClass(o,[{key:"init",value:function(){t.templates&&t.templates.init({customImport:!0}),this.templateInstalled(),this.restoreButton()}},{key:"events",value:function(){var n=this;d(document).on("click","#js__cp_template_uninstall",function(t){t.preventDefault();var e=d(this);jupiterx_modal({title:jupiterx_cp_textdomain.important_notice,text:jupiterx_cp_textdomain.uninstalling_template_will_remove_all_your_contents_and_settings,type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.yes_uninstall+e.data("title"),showCloseButton:!1,showLearnmoreButton:!1,onConfirm:function(){n.uninstallTemplate()}})}),d(document).on("click","#js__restore-template-btn",function(t){t.preventDefault(),n.restoreBackup()}),d(window).on("template-installed",function(t,e){e.partial||(n.templateInstalled(e.title,e.id),n.restoreButton())})}},{key:"uninstallTemplate",value:function(){jupiterx_modal({title:jupiterx_cp_textdomain.uninstalling_Template,text:jupiterx_cp_textdomain.please_wait_for_few_moments,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,progress:"100%"}),d.post(_wpUtilSettings.ajax.url,{action:"abb_uninstall_template"}).done(function(){d("#js__installed-template-wrap").hide(),jupiterx_modal({title:jupiterx_cp_textdomain.hooray,text:jupiterx_cp_textdomain.template_uninstalled,type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1}),jupiterxTemplates.template=null}).fail(function(t){console.log("Failed msg : ",t)})}},{key:"templateInstalled",value:function(t,e){var n=this,i=d("#js__installed-template");if(i.length&&(t||(t=i.data("installed-template")),e||(e=i.data("installed-template-id")),!(t<=0&&e<=0))){var o={action:"abb_template_lazy_load",from:0,count:1,template_id:e,template_name:t};d.post(_wpUtilSettings.ajax.url,o,function(t){!0===t.status&&0<t.data.templates.length&&d.each(t.data.templates,function(t,e){d("#js__installed-template-wrap").show(),i.attr("data-installed-template-id",e.id).attr("data-installed-template",e.slug).empty().append(n.templateUI(e))})})}}},{key:"templateUI",value:function(t){return'\n        <div class="jupiterx-cp-template-item">\n          <div class="jupiterx-cp-template-item-inner jupiterx-card">\n            <figure class="jupiterx-cp-template-item-fig">\n              <img src="'+t.img_url+'" alt="'+t.name+'">\n            </figure>\n            <div class="jupiterx-cp-template-item-meta jupiterx-card-body">\n              <h4 class="jupiterx-cp-template-item-name text-truncate" title="'+t.name.replace(" Jupiterx","")+'">'+t.name.replace(" Jupiterx","")+'</h4>\n              <div class="jupiterx-cp-template-item-buttons '+(t.psd_file?" has-psd":"")+'">\n                <a id="js__cp_template_uninstall" class="btn btn-outline-danger mr-2 jupiterx-cp-template-item-btn" href="#" data-title="'+t.name.replace(" Jupiterx","")+'" data-name="'+t.name+'" data-slug="'+t.slug+'" data-id="'+t.id+'">'+jupiterx_cp_textdomain.remove+'</a>\n                <a class="btn btn-outline-secondary mr-2 jupiterx-cp-template-item-btn" href="https://jupiterx.artbees.net/'+t.slug.replace("-jupiterx","")+'" target="_blank">'+jupiterx_cp_textdomain.preview+"</a>\n              </div>\n            </div>\n          </div>\n        </div>\n      "}},{key:"restoreButton",value:function(){jupiterxControlPanel.jupiterxCoreActive&&d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"abb_is_restore_db"},dataType:"json",success:function(t){var e=t.data,n=[],i="";e.hasOwnProperty("list_of_backups")?null===(n=e.list_of_backups)?console.log("List Of Backups is NULL!"):0===n.length?console.log("List Of Backups is EMPTY!"):(i=e.latest_backup_file.created_date,d("#js__backup-date").text(i),d("#js__restore-template-wrap").addClass("is-active"),console.log("Restore Buttons Created Successfully!")):console.log("No backup files found!")},error:function(t,e,n){console.log("Fail: ",t)}})}},{key:"restoreBackup",value:function(){d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"abb_is_restore_db"},dataType:"json",success:function(t){var e=t.data.latest_backup_file.created_date;jupiterx_modal({title:jupiterx_cp_textdomain.restore_settings,text:"<p>"+jupiterx_cp_textdomain.you_are_trying_to_restore_your_theme_settings_to_this_date+"<strong class='jupiterx-tooltip-restore--created-date'>"+e+"</strong>. "+jupiterx_cp_textdomain.are_you_sure+"</p>",type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.restore,showCloseButton:!1,showLearnmoreButton:!1,onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.restoring_database,text:jupiterx_cp_textdomain.please_wait_for_few_moments,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0}),d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"abb_restore_latest_db"},dataType:"json",success:function(t){t.status?jupiterx_modal({title:t.message,text:jupiterx_cp_textdomain.restore_ok,type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!0,confirmButtonText:jupiterx_cp_textdomain.reload_page,onConfirm:function(){location.reload()}}):jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:t.message,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})},error:function(t,e,n){console.log("Fail: ",t)}})}})},error:function(t,e,n){console.log("Fail: ",t)}})}}]),o);function o(){_classCallCheck(this,o),this.init(),this.events()}var a=(_createClass(s,[{key:"events",value:function(){var n=this;d(".jupiterx-cp-settings-flush").on("click",function(){n.send("flush")}),d(".jupiterx-cp-settings-form").on("submit",function(t){t.preventDefault();var e=d(this),i={};d.map(e.serializeArray(),function(t){var e=t.name,n=t.value;t.name.endsWith("[]")&&(e=e.replace("[]",""),n=i[e]||[],t.value&&n.push(t.value)),i[e]=n}),n.send("save",i)}),d(".jupiterx-image-uploader").each(function(t,e){var n=d(e),i=n.find("input"),o=n.find(".remove-button"),a=wp.media({multiple:!1,title:jupiterx_cp_textdomain.select_zip_file,button:{text:jupiterx_cp_textdomain.select}});a.on("select",function(){var t=a.state().get("selection").first().toJSON();i.val(t.url),n.addClass("has-image")}),n.on("click","input, .upload-button",function(){event.preventDefault(),a.open()}),o.on("click",function(t){t.preventDefault(),i.val(""),n.removeClass("has-image")})}),d("[data-for]").each(function(t,e){var n=d(e),i=d("input[type=checkbox][name="+n.data("for")+"]");i.on("change",function(){n.toggleClass("hidden",!i.is(":checked"))})}),d("#jupiterx-cp-settings-white-label-mode").on("change",function(){n.whiteLabelModeChanged=!0})}},{key:"send",value:function(t,e){function n(){setTimeout(function(){a.addClass("d-none text-muted").text(s)},3e3)}var i=1<arguments.length&&void 0!==e?e:null,o=this,a=d(".jupiterx-cp-settings-"+t+"-feedback"),s=a.text();a.removeClass("d-none"),wp.ajax.send("jupiterx_cp_settings",{data:{nonce:jupiterxControlPanel.nonce,type:t,fields:i},success:function(t){a.removeClass("text-muted").addClass("text-success").text(t),n(),i&&("1"===i.jupiterx_white_label||o.whiteLabelModeChanged&&"0"===i.jupiterx_white_label)&&window.location.reload()},error:function(t){a.removeClass("text-muted").addClass("text-danger").text(t),n()}})}}]),s);function s(){_classCallCheck(this,s),this.whiteLabelModeChanged=!1,this.events()}var r=(_createClass(u,[{key:"events",value:function(){var i=this;d("#jupiterx-mods-cleanup").on("click",function(t){t.preventDefault();var e=d(this),n={action:"jupiterx_cp_cleanup_mods",nonce:e.attr("data-nonce")};e.replaceWith('\n          <span class="status-state">\n            <span class="jupiterx-cleanup-spinner spinner is-active"></span>\n          </span>\n        '),i.cleanupThemeMods(n)}),d(".jupiterx-button--get-system-report").click(function(){var s="";d("#jupiterx-cp-system-status thead, #jupiterx-cp-system-status tbody").each(function(){var t=d(this);if(t.is("thead")){var e=t.find("th:eq(0)").data("export-label")||t.text();s=s+"\n### "+d.trim(e)+" ###\n\n"}else d("tr",t).each(function(){var t=d(this),e=t.find("td:eq(0)").data("export-label")||t.find("td:eq(0)").text(),n=d.trim(e).replace(/(<([^>]+)>)/gi,""),i=d.trim(t.find("td:eq(2)").text().replace(/(\r\n\t|\n|\r|\t)/gm,"")),o=i.split(", ");if(1<o.length){var a="";d.each(o,function(t,e){a=a+e+"\n"}),i=a}s=s+""+n+": "+i+"\n"})});try{return d("#jupiterx-textarea--get-system-report").slideDown(),d("#jupiterx-textarea--get-system-report textarea").val(s).focus().select(),!1}catch(t){console.log(t)}return!1}),d("[data-jupiterx-ajax]").each(function(){var t=d(this),e=t.data("jupiterxAjax"),n=t.find(".status-state"),i=t.find(".status-text");wp.ajax.send("jupiterx_cp_system_status",{data:{nonce:jupiterxControlPanel.nonce,type:e},success:function(){n.html('<span class="status-invisible">True</span><span class="status-state status-true"></span>')},error:function(t){n.html('<span class="status-invisible">False</span><span class="status-state status-false"></span>'),i.html(t)}})})}},{key:"cleanupThemeMods",value:function(e){var n=this;d.post(_wpUtilSettings.ajax.url,e,function(t){t.success?n.cleanupThemeMods(e):d(".jupiterx-cleanup-spinner").replaceWith('\n            <span class="status-state">\n              <span class="status-invisible">True</span>\n              <span class="status-state status-true"></span>\n            </span>\n          ')})}}]),u);function u(){_classCallCheck(this,u),this.events()}var l=(_createClass(p,[{key:"events",value:function(){d(document).on("click",".js__cp_change_theme_version",this.updateTheme),d(document).on("click",".release-download",this.releaseDownload)}},{key:"releaseDownload",value:function(t){t.preventDefault(),t.stopPropagation();var e=d(this);if("active"===(e.attr("status")||"active")){var n=e.data("release-id"),i=e.data("release-package"),o=e.data("nonce");e.attr("status","deactive"),setTimeout(function(){e.attr("status","active")},9e3),jQuery.ajax({url:_wpUtilSettings.ajax.url,type:"POST",data:{security:o,release_id:n,release_package:i,action:"jupiterx_get_theme_release_package_url"},success:function(t){t.success&&(top.location.href=t.data)},error:function(t){console.log(t),alert("An error occurred.")}})}}},{key:"updateTheme",value:function(t){t.preventDefault();var i=d(this),e=i.data("release-id"),o=i.data("release-version"),a=i.data("nonce"),s=i.siblings(".jupiterx-cp-update-feedback");jupiterx_modal({title:jupiterx_cp_textdomain.please_note,text:jupiterx_cp_textdomain.any_customisation_you_have_made_to_theme_files_will_be_lost,type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.agree,cancelButtonText:jupiterx_cp_textdomain.discard,showCloseButton:!0,showLearnmoreButton:!1,onConfirm:function(){var n=[{text:jupiterx_cp_textdomain.apikey_domain_match_error,helpLink:'<a href="https://themes.artbees.net/docs/updating-jupiter-x-theme-automatically/" target="_blank">'+jupiterx_cp_textdomain.learn_more+"</a>"}];s.removeClass("d-none"),i.addClass("disabled loading"),wp.ajax.send("jupiterx_modify_auto_update",{data:{security:a,release_id:e,release_version:o},success:function(){wp.updates.ajax("update-theme",{slug:"jupiterx",success:function(){s.removeClass("text-muted").addClass("text-success").text(jupiterx_cp_textdomain.theme_update_success),i.removeClass("disabled loading"),window.location.reload()},error:function(t){var e=t&&t.errorCode?t.errorCode:"";"files_not_writable"===e||"remove_old_failed"===e?s.removeClass("text-muted").addClass("text-danger").html(jupiterx_cp_textdomain.theme_update_failed_due_to_permission+' <a href="https://themes.artbees.net/docs/template-cant-be-installed/" target="_blank">'+jupiterx_cp_textdomain.learn_more+".</a>"):s.removeClass("text-muted").addClass("text-danger").text(jupiterx_cp_textdomain.theme_update_failed),i.removeClass("disabled loading")}})},error:function(t){i.removeClass("disabled loading"),s.removeClass("text-muted").addClass("text-danger").html(t+" "+function(t){var e=_.findWhere(n,{text:t});return e?e.helpLink:""}(t))}})}})}}]),p);function p(){_classCallCheck(this,p),this.events()}var c=(_createClass(m,[{key:"events",value:function(){var e=this;d(".js__cp-clist-add-item").on("click",function(t){t.preventDefault(),e.add()}),d(".js__cp-clist-edit-item").on("click",function(t){t.preventDefault(),e.edit(d(this))}),d(".js__cp-clist-remove-item").on("click",function(t){t.preventDefault(),e.remove(d(this))}),d(document).on("blur",'.js__add-new-image-size input[type="number"]',function(t){var e=new Number(t.target.value);(isNaN(e)||e<parseInt(t.target.min))&&d(this).val("")})}},{key:"add",value:function(){var t=this,e="";e+='<div class="jupiterx-modal-header">',e+='<span class="jupiterx-modal-icon"></span>',e+='<h3 class="jupiterx-modal-title">'+jupiterx_cp_textdomain.add_image_size+"</h3>",e+="</div>",e+='<div class="jupiterx-modal-desc">',e+='<div class="form-group mb-3">',e+="<label><strong>"+jupiterx_cp_textdomain.image_size_name+"</strong></label>",e+='<input class="jupiterx-form-control" name="size_n" type="text" required />',e+="</div>",e+='<div class="form-row">',e+='<div class="form-group col-md-6">',e+="<label><strong>"+jupiterx_cp_textdomain.image_size_width+"</strong></label>",e+='<input class="jupiterx-form-control" min="1" name="size_w" step="1" type="number" required />',e+="</div>",e+='<div class="form-group col-md-6">',e+="<label><strong>"+jupiterx_cp_textdomain.image_size_height+"</strong></label>",e+='<input class="jupiterx-form-control" min="1" name="size_h" id="size_h" step="1" type="number" required />',e+="</div>",e+="</div>",e+='<div class="custom-control custom-checkbox form-group mb-3">',e+='<input type="checkbox" class="custom-control-input" id="size_c" name="size_c" checked="checked">',e+='<label class="custom-control-label" for="size_c"><strong>'+jupiterx_cp_textdomain.image_size_crop+"</strong></label>",e+="</div>",e+="</div>";var n=jupiterx_modal({modalCustomClass:"js__add-new-image-size",type:"warning",html:d(e),showCloseButton:!0,showConfirmButton:!0,showCancelButton:!0,closeOnOutsideClick:!0,closeOnConfirm:!1,confirmButtonText:jupiterx_cp_textdomain.save,cancelButtonText:jupiterx_cp_textdomain.discard,onConfirm:function(){t.apply(!1,n)}})}},{key:"edit",value:function(t){var e=this,n=t,i=n.closest(".js__cp-image-size-item"),o=n.closest(".jupiterx-card-body"),a=o.find("[name=size_n]").val(),s=o.find("[name=size_w]").val(),r=o.find("[name=size_h]").val(),u=o.find("[name=size_c]").val();u="on"===u&&'checked="checked"';var l="";l+='<div class="jupiterx-modal-header">',l+='<span class="jupiterx-modal-icon"></span>',l+='<h3 class="jupiterx-modal-title">'+jupiterx_cp_textdomain.edit_image_size+"</h3>",l+="</div>",l+='<div class="jupiterx-modal-desc">',l+='<div class="form-group mb-3">',l+="<label><strong>"+jupiterx_cp_textdomain.image_size_name+"</strong></label>",l+='<input class="jupiterx-form-control" name="size_n" type="text" value="'+a+'" required />',l+="</div>",l+='<div class="form-row">',l+='<div class="form-group col-md-6">',l+="<label><strong>"+jupiterx_cp_textdomain.image_size_width+"</strong></label>",l+='<input class="jupiterx-form-control" min="1" name="size_w" step="1" type="number"  value="'+s+'" required />',l+="</div>",l+='<div class="form-group col-md-6">',l+="<label><strong>"+jupiterx_cp_textdomain.image_size_height+"</strong></label>",l+='<input class="jupiterx-form-control" min="1" name="size_h" id="size_h" step="1" type="number"  value="'+r+'" required />',l+="</div>",l+="</div>",l+='<div class="custom-control custom-checkbox form-group mb-3">',l+='<input type="checkbox" class="custom-control-input" id="size_c" name="size_c" '+u+">",l+='<label class="custom-control-label" for="size_c"><strong>'+jupiterx_cp_textdomain.image_size_crop+"</strong></label>",l+="</div>",l+="</div>";var p=jupiterx_modal({modalCustomClass:"js__add-new-image-size",type:"warning",html:d(l),showCloseButton:!0,showConfirmButton:!0,showCancelButton:!0,closeOnOutsideClick:!0,closeOnConfirm:!1,confirmButtonText:jupiterx_cp_textdomain.save,cancelButtonText:jupiterx_cp_textdomain.discard,onConfirm:function(){e.apply(i,p)}})}},{key:"remove",value:function(t){var e=this,n=t;jupiterx_modal({title:jupiterx_cp_textdomain.remove_image_size,text:jupiterx_cp_textdomain.are_you_sure_remove_image_size,type:"warning",showCancelButton:!0,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,onConfirm:function(){n.closest(".jupiterx-img-size-item").remove(),e.save()}})}},{key:"apply",value:function(t,e){var n="",i=d(".js__add-new-image-size"),o=i.find("[name=size_n]"),a=i.find("[name=size_w]"),s=i.find("[name=size_h]"),r=i.find("[name=size_n]").val(),u=i.find("[name=size_w]").val(),l=i.find("[name=size_h]").val(),p=i.find("[name=size_c]:checked").val(),c="on"==(p="on"==p?"on":"off")?jupiterx_cp_textdomain.on:jupiterx_cp_textdomain.off;""!=r?(o.removeClass("is-invalid"),""!=u?(a.removeClass("is-invalid"),""!=l?(s.removeClass("is-invalid"),n+='<div class="jupiterx-img-size-item js__cp-image-size-item">',n+='<div class="jupiterx-img-size-item-inner jupiterx-card">',n+='<div class="jupiterx-card-body fetch-input-data">',n+='<div class="js__size-name mb-3"><strong>'+jupiterx_cp_textdomain.size_name+":</strong> "+r+"</div>",n+='<div class="js__size-dimension mb-3"><strong>'+jupiterx_cp_textdomain.image_size+":</strong> "+u+"px "+l+"px</div>",n+='<div class="js__size-crop mb-3"><strong>'+jupiterx_cp_textdomain.crop+":</strong><span> "+c+"</span></div>",n+='<button type="button" class="btn btn-outline-success js__cp-clist-edit-item mr-1">'+jupiterx_cp_textdomain.edit+"</button>",n+='<button type="button" class="btn btn-outline-danger js__cp-clist-remove-item">'+jupiterx_cp_textdomain.remove+"</button>",n+='<input name="size_n" type="hidden" value="'+r+'" />',n+='<input name="size_w" type="hidden" value="'+u+'" />',n+='<input name="size_h" type="hidden" value="'+l+'" />',n+='<input name="size_c" type="hidden" value="'+p+'" />',n+="</div>",n+="</div>",0<t.length?(t.after(n),t.remove()):d(".js__jupiterx-img-size-list").append(n),e.close(),this.events(),this.save()):s.addClass("is-invalid")):a.addClass("is-invalid")):o.addClass("is-invalid")}},{key:"save",value:function(){var t=d(".js__jupiterx-img-size-list"),e=[];t.find(".js__cp-image-size-item").each(function(){e.push(d(this).find(".fetch-input-data input").serialize())});var n=jupiterx_modal({title:jupiterx_cp_textdomain.saving_image_size,text:jupiterx_cp_textdomain.wait_for_image_size_update,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0});jQuery.ajax({url:_wpUtilSettings.ajax.url,type:"POST",data:{action:"jupiterx_save_image_sizes",options:e,security:d("#security").val()},success:function(t){n.close(),1!=t&&jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:jupiterx_cp_textdomain.image_sizes_could_not_be_stored,type:"error",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1})},error:function(t){console.log(t),jupiterx_modal({type:"error",title:jupiterx_cp_textdomain.error,text:t+" "+jupiterx_cp_textdomain.issue_persists,showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnConfirm:!1,confirmButtonText:jupiterx_cp_textdomain.try_again,closeOnOutsideClick:!1,onConfirm:function(){window.location.reload()}})}})}}]),m);function m(){_classCallCheck(this,m),this.events()}var x=(_createClass(f,[{key:"events",value:function(){var e=this;d(".jupiterx-cp-export-form").on("submit",function(t){t.preventDefault(),e.export(d(this))}),d(".jupiterx-cp-import-btn").on("click",function(t){t.preventDefault(),e.import()}),d(".jupiterx-cp-import-upload-btn").on("click",function(t){t.preventDefault(),e.upload(t)})}},{key:"export",value:function(t){var e=this;e.steps=[],e.modal="",e.cancel="";var n=t.serializeArray();e.data.filename=n[0].value,n=_.reject(n,function(t){return"filename"==t.name}),e._mapOptions(n)&&(e.modal=jupiterx_modal({type:!1,title:jupiterx_cp_textdomain.exporting+' <span class="cp-export-step">'+e.steps[1]+"</span>...",text:jupiterx_cp_textdomain.export_waiting,showCancelButton:!0,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,progress:"100%",indefiniteProgress:!0,cancelButtonText:jupiterx_cp_textdomain.discard,closeOnConfirm:!1,closeOnOutsideClick:!1,onCancel:function(){e.steps=[],e.cancel=!0,e.send("Export","Discard"),e.modal.close()}}),e.send("Export",_.first(e.steps)))}},{key:"import",value:function(){var e=this;e.steps=[],e.modal="",e.cancel="";var t=d(".jupiterx-cp-import-wrap .jupiterx-form-control").data("id");if(void 0===t)return!1;e.attachmentId=t,e.modal=jupiterx_modal({type:!1,title:"Import",text:"\n          "+jupiterx_cp_textdomain.import_select_options+'\n          <form class="jupiterx-cp-import-form">\n            <label>\n              <input type="checkbox" name="check" value="Content" checked>\n              '+jupiterx_cp_textdomain.site_content+'\n            </label>\n            <label>\n              <input type="checkbox" name="check" value="Widgets" checked>\n              '+jupiterx_cp_textdomain.widgets+'\n            </label>\n            <label>\n              <input type="checkbox" name="check" value="Settings" checked>\n              '+jupiterx_cp_textdomain.settings+"\n            </label>\n          </form>\n        ",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!0,showLearnmoreButton:!1,showProgress:!1,closeOnConfirm:!1,confirmButtonText:jupiterx_cp_textdomain.import,onConfirm:function(){var t=d(".jupiterx-cp-import-form").serializeArray();e._mapOptions(t)&&(jupiterx_modal({type:!1,title:jupiterx_cp_textdomain.importing+' <span class="cp-export-step">'+e.steps[1]+"</span>...",text:jupiterx_cp_textdomain.import_waiting,showCancelButton:!0,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0,cancelButtonText:jupiterx_cp_textdomain.discard,closeOnOutsideClick:!1,closeOnConfirm:!1,onCancel:function(){e.steps=[],e.cancel=!0,e.send("Import","Discard"),e.modal.close()}}),e.send("Import",_.first(e.steps)))}})}},{key:"upload",value:function(t){var e=void 0,n=d(t.target).parents(".jupiterx-upload-wrap").find("input");e||(e=wp.media({multiple:!1,title:jupiterx_cp_textdomain.select_zip_file,button:{text:jupiterx_cp_textdomain.select}})).on("select",function(){var t=e.state().get("selection").first().toJSON();n.attr("data-id",t.id),n.val(t.url)}),e.open()}},{key:"send",value:function(i,t){var o=this;wp.ajax.send("jupiterx_cp_export_import",{data:{nonce:jupiterxControlPanel.nonce,type:i,step:t,attachment_id:o.attachmentId,data:o.data},success:function(t){o.steps=_.without(o.steps,t.step);var e=_.first(o.steps);if(o.steps.length)"Start"!==t.step&&d(".cp-export-step").text(t.step),o.send(i,e);else{if(!0===o.cancel)return;var n="Export"===i?jupiterx_cp_textdomain.download:jupiterx_cp_textdomain.close;jupiterx_modal({type:"success",title:i+" "+jupiterx_cp_textdomain.done,text:i+" "+jupiterx_cp_textdomain.successfully_finished,showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnConfirm:!1,confirmButtonText:n,onConfirm:function(){"Export"===i&&(window.location.href=t.download_url),o.modal.close()}})}},error:function(t){console.log(t),jupiterx_modal({type:"error",title:jupiterx_cp_textdomain.error,text:t+" "+jupiterx_cp_textdomain.issue_persists,showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnConfirm:!1,confirmButtonText:jupiterx_cp_textdomain.try_again,onConfirm:function(){window.location.reload(),o.modal.close()}})}})}},{key:"_mapOptions",value:function(t){var e=this;return _.map(t,function(t){return e.steps.push(t.value)}),!!e.steps.length&&(e.steps.unshift("Start"),e.steps.push("End"),!0)}}]),f);function f(){_classCallCheck(this,f),this.steps=[],this.modal="",this.cancel="",this.data={},this.attachmentId="",this.events()}var g=(_createClass(h,[{key:"init",value:function(){var n=this,t=localStorage.getItem("plugins");if(_.isEmpty(t))d.post(_wpUtilSettings.ajax.url,{action:"abb_get_plugins"},function(t){if(_.isEmpty(t.plugins))return n.$plugins.html(""),void n.$header.after(d('\n              <div class="jupiterx-cp-plugins-notices">\n                <div class="alert alert-danger">'+jupiterx_cp_textdomain.api_request_error+"</div>\n              </div>"));var e=n.sortByLabel(t.plugins);n.plugins=[].concat(_toConsumableArray(e)),n.limit=t.limit,n.render()});else{t=JSON.parse(t);var e=n.sortByLabel(t);n.plugins=[].concat(_toConsumableArray(e)),n.limit=localStorage.getItem("limit"),n.render(),localStorage.removeItem("plugins"),localStorage.removeItem("limit")}}},{key:"updateState",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:{},o=2<arguments.length&&void 0!==n&&n,a=this;_.isArray(t)||(t=[t]),!t.length||a.isOldAPIVersion(t[0])?(_.each(t,function(e){var t=_.findIndex(a.plugins,function(t){return t.slug===e.slug});e=_extends({},e,i),a.plugins[t]=_extends({},e),a.plugins[t].html.attr("data-update",a.plugins[t].update_needed?"yes":"no"),e.server_version&&!1===e.update_needed&&(e.html.find(".item-version-tag").text(e.server_version),a.plugins[t].version=e.server_version),!0===e.pro&&(e.html.find(".jupiterx-pro-badge").remove(),e.html.find(".jupiterx-card").prepend('<img class="jupiterx-pro-badge" src="'+jupiterxControlPanel.proBadgeUrl+'" />')),o||(a.plugins[t].html.find(".btn").remove(),a.plugins[t].html.find(".jupiterx-card-body").append(a.buttons(a.plugins[t])))}),a.notices(o),a.filters(o),o&&(a.runCache(),location.reload())):location.reload()}},{key:"runCache",value:function(){var t=this.plugins.map(function(t){return _extends({},t,{html:null})});localStorage.setItem("plugins",JSON.stringify(t)),localStorage.setItem("limit",this.limit)}},{key:"events",value:function(){var e=this;d(document).on("click",".abb_plugin_activate",function(t){t.preventDefault(),e.handleActivate(d(this))}),d(document).on("click",".abb_plugin_install",function(t){t.preventDefault(),e.handleInstall(d(this))}),d(document).on("click",".abb_plugin_deactivate",function(t){t.preventDefault(),e.handleDeactivate(d(this))}),d(document).on("click",".abb_plugin_delete",function(t){t.preventDefault(),e.handleDelete(d(this))}),d(document).on("click",".abb_plugin_update",function(t){t.preventDefault(),e.handleUpdate(d(this))}),d(document).on("click",".jupiterx-cp-plugins-filter > .btn",function(t){t.preventDefault(),e.handleFilter(d(this))}),d(document).on("click",".jupiterx-cp-activate-plugins",function(t){t.preventDefault(),e.handleActivatePlugins(d(this))}),d(document).on("click",".jupiterx-cp-update-plugins",function(t){t.preventDefault(),e.handleUpdatePlugins(d(this))})}},{key:"render",value:function(){var i=this;this.isPlugin2()?this.$actionsRequired.append(i.$notices):(i.$notices=d('<div class="jupiterx-cp-plugins-notices">\n          <div class="alert alert-warning">'+jupiterx_cp_textdomain.plugins_notice+"</div>\n        </div>"),i.$header.after(i.$notices)),i.notices(!1),i.$filters=d(".jupiterx-cp-plugins-filter"),i.$filters.removeClass("disabled"),i.$filters.find(".btn").removeAttr("disabled"),i.filters(),i.$plugins.html(""),i.$pluginsRequired.html(""),i.$pluginsOptional.html(""),this.isPlugin2()?(_.each(i.plugins,function(t,e){if("false"!=t.required){var n=d(i.card(t));i.plugins[e].html=n,i.$pluginsRequired.append(n)}}),_.each(i.plugins,function(t,e){if("true"!=t.required){var n=d(i.card(t));i.plugins[e].html=n,i.$pluginsOptional.append(n)}})):_.each(i.plugins,function(t,e){var n=d(i.card(t));i.plugins[e].html=n,i.$plugins.append(n)});var t=localStorage.getItem("activeFilter");t&&i.$filters.find(".btn[data-filter="+t+"]").click()}},{key:"notices",value:function(t){if(!(0<arguments.length&&void 0!==t&&t)){var e=this;if(!e.plugins.length||e.isOldAPIVersion(e.plugins[0])){this.isPlugin2()&&(e.$notices=this.$actionsRequired);var n=_.filter(e.plugins,function(t){return e.isActivateNeeded(t)}),i=_.filter(e.plugins,function(t){return e.isUpdateNeeded(t)});e.$notices.find(".jupiterx-cp-activate-plugins").remove(),n.length&&e.$notices.append('<button type="button" class="jupiterx-cp-activate-plugins btn btn-primary">'+jupiterx_cp_textdomain.activate_required_plugins+"</button>"),e.$notices.find(".jupiterx-cp-update-plugins").remove(),i.length&&e.$notices.append('<button type="button" class="jupiterx-cp-update-plugins btn btn-warning ml-3">'+jupiterx_cp_textdomain.update_all_plugins+"</button>")}}}},{key:"filters",value:function(t){if(!(0<arguments.length&&void 0!==t&&t)){var e=this,n=localStorage.getItem("activeFilter"),i=_.filter(e.plugins,function(t){return e.isUpdateNeeded(t)}),o="";e.$filters.find(".btn[data-filter=update]").remove(),i.length&&(o+='<button type="button" class="btn btn-outline-secondary" data-filter="update">'+jupiterx_cp_textdomain.updates_available+"</button>"),e.$filters.append(o),"update"!==n||i.length?"update"===n&&i.length&&d(".jupiterx-cp-plugins-filter > .btn[data-filter=update]").trigger("click"):d(".jupiterx-cp-plugins-filter > .btn[data-filter=all]").trigger("click")}}},{key:"handleFilter",value:function(t){var e=t.data("filter");if(localStorage.setItem("activeFilter",e),d(".jupiterx-cp-plugins-filter .btn").removeClass("btn-secondary").addClass("btn-outline-secondary"),t.removeClass("btn-outline-secondary").addClass("btn-secondary"),"all"!==e){if("update"===e)return d(".jupiterx-cp-plugin-item").show(),void d(".jupiterx-cp-plugin-item").not("[data-update=yes]").hide();d(".jupiterx-cp-plugin-item").show(),d(".jupiterx-cp-plugin-item").not("[data-filter="+e+"]").hide()}else d(".jupiterx-cp-plugin-item").show()}},{key:"sortByLabel",value:function(i){var o=[];return _.isObject(i)&&(i=Object.keys(i).map(function(t){return i[t]})),["required","recommended","optional"].forEach(function(n){i.forEach(function(t,e){("optional"===n&&-1===o.indexOf(e)||-1===o.indexOf(e)&&t[n]&&"false"!==t[n])&&(i[e].labeled_as=n,o.push(e))})}),o=o.map(function(t){return i[t]})}},{key:"card",value:function(t){var e=this.buttons(t);return'\n        <div class="jupiterx-cp-plugin-item" data-filter="'+(!0===t.active?"active":"inactive")+'" data-update="'+(this.isUpdateNeeded(t)?"yes":"no")+'">\n          <div class="jupiterx-cp-plugin-item-inner jupiterx-card">\n            '+(t.pro||this.isProPlugin(t)?'<img class="jupiterx-pro-badge" src="'+jupiterxControlPanel.proBadgeUrl+'" />':"")+'\n            <div class="jupiterx-card-body">\n              <figure class="jupiterx-cp-plugin-item-thumb">\n                <img src="'+t.img_url+'">\n              </figure>\n              <div class="jupiterx-cp-plugin-meta-wrapper">\n                <span class="jupiterx-cp-plugin-item-label label-'+t.labeled_as+'">'+jupiterx_cp_textdomain[t.labeled_as]+'</span>\n                <span class="jupiterx-cp-plugin-item-version">\n                  v<span class="item-version-tag">'+t.version+'</span>\n                </span>\n              </div>\n              <div class="jupiterx-cp-plugin-item-meta">\n                <div class="jupiterx-cp-plugin-item-name">'+t.name+'</div>\n                <div class="jupiterx-cp-plugin-item-desc">\n                  '+t.desc+"\n                  "+(t.more_link?'<a href="'+t.more_link+'" target="_blank">'+jupiterx_cp_textdomain.learn_more+"</a>":"")+"\n                </div>\n              </div>\n              "+e+"\n            </div>\n          </div>\n        </div>\n      "}},{key:"getActivationLimit",value:function(t){var e=(this.limit||"").split(",");return-1<e.indexOf("num")||-1<["layerslider","masterslider","revslider"].indexOf(t.slug)&&-1<e.indexOf("sliders")||-1<["jet-blog","jet-elements","jet-engine","jet-menu","jet-popup","jet-smart-filters","jet-tabs","jet-tricks","jet-woo-builder"].indexOf(t)&&-1<e.indexOf("jet-plugins")}},{key:"buttons",value:function(t){var e=this.isMultisite,n="",i=this.getActivationLimit(t);return t.installed?t.network_active?'<span class="btn btn-sm network-active" href="#">\n          '+jupiterx_cp_textdomain.network_active+"\n        </span>":(this.isUpdateNeeded(t)&&(n+='<a class="btn btn-sm btn-warning abb_plugin_update" data-basename="'+t.basename+'" data-slug="'+t.slug+'" href="#" data-name="'+t.name+'">\n          '+jupiterx_cp_textdomain.update+"\n        </a>"),!0===t.active?n+='<a class="btn btn-sm btn-danger abb_plugin_deactivate" data-basename="'+t.basename+'" data-slug="'+t.slug+'" href="#" data-name="'+t.name+'">\n          '+jupiterx_cp_textdomain.deactivate+"\n        </a>":(n+='<a class="btn btn-sm btn-primary abb_plugin_activate" data-slug="'+t.slug+'" href="'+(t.activate_url?t.activate_url:t.url)+'" data-name="'+t.name+'" data-limit="'+i+'">\n          '+jupiterx_cp_textdomain.activate+"\n        </a>",e||(n+='<a class="btn btn-sm btn-outline-danger jupiterx-icon-times-circle abb_plugin_delete" data-basename="'+t.basename+'" data-slug="'+t.slug+'" href="#" data-name="'+t.name+'">\n            '+jupiterx_cp_textdomain.delete+"\n          </a>")),n):t.pro||this.isProPlugin(t)?'<a class="btn btn-sm jupiterx-btn-upgrade-pro jupiterx-icon-pro" href="'+jupiterx_cp_textdomain.upgrade_url+'" target="_blank">\n            '+jupiterx_cp_textdomain.upgrade+"\n          </a>":'<a class="btn btn-sm btn-outline-success jupiterx-icon-plus-circle-solid abb_plugin_install '+(t.install_disabled?"disabled":"")+'" data-slug="'+t.slug+'" href="'+(t.install_url?t.install_url:t.url)+'" data-name="'+t.name+'">\n          '+jupiterx_cp_textdomain.install+"\n        </a>"}},{key:"handleInstall",value:function(t){var e=this,n=t.data("name"),i=t.data("slug"),o=t.attr("href"),a=_.findWhere(e.plugins,{slug:i});jupiterx_modal({title:jupiterx_cp_textdomain.install_plugin,text:e.language(jupiterx_cp_textdomain.you_are_about_to_install,[n]),type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.installing_plugin,text:jupiterx_cp_textdomain.wait_for_plugin_install,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0,closeOnOutsideClick:!1}),e.actionInstall({url:o,onSuccess:function(){jupiterx_modal({title:jupiterx_cp_textdomain.plugin_is_successfully_installed,text:e.language(jupiterx_cp_textdomain.plugin_installed_successfully_message,[n]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,onConfirm:function(){e.updateState(a,{installed:!0,active:!1})}});var t=d("#jupiterx-modal");t.find(".js__modal-btn-confirm").addClass("btn-outline-primary").removeClass("btn-primary"),t.find(".jupiterx-modal-footer").append('<a class="btn btn-primary jupiterx-modal-activate-plugin abb_plugin_activate" data-slug="'+a.slug+'" href="'+a.activate_url+'" data-name="'+a.name+'">\n                  '+jupiterx_cp_textdomain.activate+"\n                </a>")},onError:function(){jupiterx_modal({title:jupiterx_cp_textdomain.install_error,text:jupiterx_cp_textdomain.install_plugin_failed,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}})}})}},{key:"handleDelete",value:function(t){var e=this,n=t.data("name"),i=t.data("slug"),o=_.findWhere(e.plugins,{slug:i});jupiterx_modal({title:jupiterx_cp_textdomain.delete_plugin,text:e.language(jupiterx_cp_textdomain.you_are_about_to_delete,[n]),type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.deleting_plugin,text:jupiterx_cp_textdomain.wait_for_plugin_delete,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0}),e.actionDelete({basename:o.basename,slug:i,onSuccess:function(){jupiterx_modal({title:jupiterx_cp_textdomain.plugin_is_successfully_deleted,text:e.language(jupiterx_cp_textdomain.plugin_deleted_successfully_message,[n]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){e.updateState(o,{installed:!1,active:!1,update_needed:!1,pro:o.is_pro&&!jupiterxControlPanel.isPro})}})}})}})}},{key:"handleActivate",value:function(t){function e(){jupiterx_modal({title:jupiterx_cp_textdomain.activating_plugin,text:jupiterx_cp_textdomain.wait_for_plugin_activation,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0,closeOnOutsideClick:!1}),n.actionActivate({url:o,slug:a,onSuccess:function(){jupiterx_modal({title:jupiterx_cp_textdomain.all_done,text:n.language(jupiterx_cp_textdomain.item_is_successfully_activated,[i]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!0,closeOnOutsideClick:!1,onConfirm:function(){n.updateState(s,{installed:!0,active:!0},!0)}})},onError:function(t){jupiterx_modal({title:jupiterx_cp_textdomain.activate_error,text:t,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}})}var n=this,i=t.data("name"),o=t.attr("href"),a=t.data("slug"),s=_.findWhere(n.plugins,{slug:a});jupiterx_modal({title:jupiterx_cp_textdomain.activating_notice,text:n.language(jupiterx_cp_textdomain.are_you_sure_you_want_to_activate,[i]),type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){!0===t.data("limit")?jupiterx_modal({title:jupiterx_cp_textdomain.plugin_limit_warning,text:jupiterx_cp_textdomain.plugin_limit_warning_message+'<a href="https://themes.artbees.net/docs/why-should-i-keep-my-active-plugins-at-minimum" target="_blank" class="jupiterx-modal-learn-more jupiterx-icon-question-circle" title="'+jupiterx_cp_textdomain.learn_more+'">'+jupiterx_cp_textdomain.learn_more+"</a>",type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){e()}}):e()}})}},{key:"handleDeactivate",value:function(t){var e=this,n=t.data("name"),i=t.data("slug"),o=_.findWhere(e.plugins,{slug:i});jupiterx_modal({title:jupiterx_cp_textdomain.important_notice,text:e.language(jupiterx_cp_textdomain.are_you_sure_you_want_to_deactivate,[n]),type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.deactivating_plugin,text:jupiterx_cp_textdomain.wait_for_plugin_deactivation,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0}),e.actionDeactivate({slug:i,onSuccess:function(){jupiterx_modal({title:jupiterx_cp_textdomain.deactivating_notice,text:e.language(jupiterx_cp_textdomain.plugin_deactivate_successfully,[]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,indefiniteProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){e.updateState(o,{installed:!0,active:!1},!0)}})}})}})}},{key:"handleUpdate",value:function(t){var e=this,n=t.data("name"),i=t.data("slug"),o=_.findWhere(e.plugins,{slug:i});jupiterx_modal({title:jupiterx_cp_textdomain.update_plugin_checker_title,text:jupiterx_cp_textdomain.update_plugin_checker_progress,type:"warning",showCancelButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,closeOnOutsideClick:!1,progress:"100%",onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.update_plugin,text:e.language(jupiterx_cp_textdomain.you_are_about_to_update,[n]),type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){jupiterx_modal({title:jupiterx_cp_textdomain.updating_plugin,text:jupiterx_cp_textdomain.wait_for_plugin_update,type:"",showCancelButton:!1,showConfirmButton:!1,showCloseButton:!1,showLearnmoreButton:!1,progress:"100%",showProgress:!0,indefiniteProgress:!0}),e.actionUpdate({url:o.update_url,onSuccess:function(){o.active?e.actionActivate({url:o.activate_url?o.activate_url:o.url,slug:o.slug,onSuccess:function(){jupiterx_modal({title:jupiterx_cp_textdomain.plugin_is_successfully_updated,text:e.language(jupiterx_cp_textdomain.plugin_updated_recent_version,[n]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){e.updateState(o,{update_needed:!1})}})},onError:function(t){jupiterx_modal({title:jupiterx_cp_textdomain.activate_error,text:t,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}}):jupiterx_modal({title:jupiterx_cp_textdomain.plugin_is_successfully_updated,text:e.language(jupiterx_cp_textdomain.plugin_updated_recent_version,[n]),type:"success",showCancelButton:!1,showConfirmButton:!0,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){e.updateState(o,{update_needed:!1})}})},onError:function(){jupiterx_modal({title:jupiterx_cp_textdomain.update_error,text:jupiterx_cp_textdomain.update_plugin_failed,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}})}})}}),jupiterx_modal.disableConfirmBtn(),e.updateChecker(i)}},{key:"handleActivatePlugins",value:function(){var s=this,r=_.filter(s.plugins,function(t){return s.isActivateNeeded(t)});jupiterx_modal({title:jupiterx_cp_textdomain.activate_required_plugins,text:jupiterx_cp_textdomain.confirm_activate_plugins,type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){var a=0,t=d('\n            <div class="jupiterx-modal-header">\n              <h3 class="jupiterx-modal-title">'+jupiterx_cp_textdomain.activating_plugins+'</h3>\n            </div>\n            <div class="jupiterx-modal-desc">\n              <ul class="jupiterx-modal-step-list jupiterx-plugins-step-list">\n                '+_.map(r,function(t){return'<li class="step-'+t.slug+'">'+t.name+' <span class="result-message"></span></li>'}).join("")+"\n              </ul>\n            </div>\n          ");jupiterx_modal({html:t,showProgress:!0,progress:"100%",showCloseButton:!1,showConfirmButton:!0,closeOnOutsideClick:!1,confirmButtonText:jupiterx_cp_textdomain.continue}),jupiterx_modal.disableConfirmBtn(),function e(){if(a>=r.length)return t.find(".jupiterx-modal-title").before(d('<span class="jupiterx-modal-icon"></span>')),t.find(".jupiterx-modal-title").text(jupiterx_cp_textdomain.activating_plugins_successful),void jupiterx_modal({html:t,type:"success",showCloseButton:!1,showConfirmButton:!0,closeOnOutsideClick:!1,confirmButtonText:jupiterx_cp_textdomain.continue,onConfirm:function(){s.updateState(r,{},!0)}});var n=r[a],i=t.find(".step-"+n.slug),o=i.find(".result-message");n.installed?(o.text(jupiterx_cp_textdomain.activating_plugin_progress),s.actionActivate({url:n.activate_url,slug:n.slug,onSuccess:function(){n.installed=!0,n.active=!0,i.addClass("step-done"),o.text(jupiterx_cp_textdomain.completed),a++,e()},onError:function(t){n.installed=!0,n.active=!1,i.addClass("step-error"),o.text(t),a++,e()}})):(o.text(jupiterx_cp_textdomain.installing_plugin_progress),s.actionInstall({url:n.install_url,onSuccess:function(){n.installed=!0,n.active=!1,e()},onError:function(){n.installed=!1,n.active=!1,i.addClass("step-error"),o.text(jupiterx_cp_textdomain.install_error),a++,e()}}))}()}})}},{key:"handleUpdatePlugins",value:function(){var s=this,r=_.filter(s.plugins,function(t){return s.isUpdateNeeded(t)});jupiterx_modal({title:jupiterx_cp_textdomain.update_all_plugins,text:jupiterx_cp_textdomain.confirm_update_plugins,type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:jupiterx_cp_textdomain.continue,showCloseButton:!1,showLearnmoreButton:!1,showProgress:!1,closeOnOutsideClick:!1,onConfirm:function(){var o=0,a=d('\n            <div class="jupiterx-modal-header">\n              <h3 class="jupiterx-modal-title">'+jupiterx_cp_textdomain.updating_plugins+'</h3>\n            </div>\n            <div class="jupiterx-modal-desc">\n              <ul class="jupiterx-modal-step-list jupiterx-plugins-step-list">\n                '+_.map(r,function(t){return'<li class="step-'+t.slug+'">'+t.name+' <span class="result-message"></span></li>'}).join("")+"\n              </ul>\n            </div>\n          ");jupiterx_modal({html:a,showProgress:!0,progress:"100%",showCloseButton:!1,showConfirmButton:!0,closeOnOutsideClick:!1,confirmButtonText:jupiterx_cp_textdomain.continue}),jupiterx_modal.disableConfirmBtn(),function e(){if(o>=r.length)return a.find(".jupiterx-modal-title").before(d('<span class="jupiterx-modal-icon"></span>')),a.find(".jupiterx-modal-title").text(jupiterx_cp_textdomain.updating_plugins_successful),void jupiterx_modal({html:a,type:"success",showCloseButton:!1,showConfirmButton:!0,closeOnOutsideClick:!1,confirmButtonText:jupiterx_cp_textdomain.continue,onConfirm:function(){s.updateState(r)}});var t=r[o],n=a.find(".step-"+t.slug),i=n.find(".result-message");i.text(jupiterx_cp_textdomain.updating_plugin_progress),s.actionUpdate({url:t.update_url,onSuccess:function(){!0===t.active?(i.text(jupiterx_cp_textdomain.activating_plugin_progress),s.actionActivate({url:t.activate_url,slug:t.slug,onSuccess:function(){n.addClass("step-done"),i.text(jupiterx_cp_textdomain.completed),o++,t.update_needed=!1,e()},onError:function(t){n.addClass("step-error"),i.text(t),o++,e()}})):(n.addClass("step-done"),i.text(jupiterx_cp_textdomain.completed),o++,t.update_needed=!1,e())},onError:function(){n.addClass("step-error"),i.text(jupiterx_cp_textdomain.update_error),o++,e()}})}()}})}},{key:"updateChecker",value:function(t){function n(t,e){var n='<table class="jupiterx_update_plugin_conflicts_table">';return n+="<thead>",n+="<tr>",n+=_.map(t,function(t){return"<th><p>"+t+"</p></th>"}).join(""),n+="</tr>",n+="</thead>",n+="<tbody>",n+=_.map(e,function(t){return"<tr><td><p>"+t.name+"</p></td><td><p>"+t.min_version+"</p></td></tr>"}).join(""),n+="</tbody>",n+="</table>"}delete(t=_extends({},t)).html,d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"abb_update_plugin_checker",plugin:t},success:function(){jupiterx_modal.enableConfirmBtn(),jupiterx_modal.hideProgressBar(),jupiterx_modal.update({desc:jupiterx_cp_textdomain.update_plugin_checker_no_conflict})},error:function(t){jupiterx_modal.enableConfirmBtn(),jupiterx_modal.hideProgressBar();var e=jupiterx_cp_textdomain.update_plugin_checker_warning;t.plugins&&0<t.plugins.length&&(e+=n([jupiterx_cp_textdomain.plugins,jupiterx_cp_textdomain.upgrade_to_version],t.plugins)),t.themes&&0<t.themes.length&&(e+=n([jupiterx_cp_textdomain.themes,jupiterx_cp_textdomain.upgrade_to_version],t.themes)),jupiterx_modal.update({desc:e})}})}},{key:"actionInstall",value:function(t){var e=t.url,n=t.onSuccess,i=t.onError;d.get({url:_.unescape(e),success:function(t){d(t).find(".jupiterx-tgmpa-error").length?i&&i(t):n&&n(t)},error:function(t,e,n){self.requestErrorHandler(t,e,n)}})}},{key:"actionDelete",value:function(e){wp.updates.ajax("delete-plugin",{plugin:e.basename,slug:e.slug,success:function(t){e.onSuccess&&e.onSuccess(t)},error:function(t){jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:t.errorMessage,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}})}},{key:"actionActivate",value:function(t){var n=t.url,i=t.onSuccess,o=t.onError,a=t.slug;d.get({url:_.unescape(n),success:function(t){var e=d(t).find("#message.error");e.length?o&&o(e.text()):"elementor"===a?d.get({url:_.unescape(n),success:function(t){i&&i(t)}}):i&&i(t)},error:function(t,e,n){self.requestErrorHandler(t,e,n)}})}},{key:"actionDeactivate",value:function(e){d.post({url:_wpUtilSettings.ajax.url,data:{action:"abb_deactivate_plugin",slug:e.slug},success:function(t){e.onSuccess&&e.onSuccess(t)},error:function(t,e,n){self.requestErrorHandler(t,e,n)}})}},{key:"actionUpdate",value:function(t){var e=t.url,n=t.onSuccess,i=t.onError;d.ajax({type:"GET",url:_.unescape(e),success:function(t){d(t).find(".jupiterx-tgmpa-error").length?i&&i(t):n&&n(t)},error:function(t){jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:_.last(t.debug),type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}})}},{key:"isProPlugin",value:function(t){return!t.installed&&t.is_pro&&!jupiterxControlPanel.isPro}},{key:"isActivateNeeded",value:function(t){return"required"===t.labeled_as&&!1===t.active&&!t.pro}},{key:"isUpdateNeeded",value:function(t){return!(this.isMultisite||!jupiterxControlPanel.isPro&&t.is_pro)&&t.installed&&!0===t.update_needed&&!t.pro}},{key:"isOldAPIVersion",value:function(t){return t.server_version}},{key:"isPlugin2",value:function(){return this.$element.find("#js__jupiterx-plugins-2").length}},{key:"language",value:function(n,t){if(void 0!==n&&""!==n){var e=t.length;return e<1||(e===(n.match(/{param}/g)||[]).length?d.each(t,function(t,e){n=n.replace("{param}",e)}):console.log("Array len and indicator lengh is not same, Contact support with ID : (3-6H1T4I) .")),n}}},{key:"requestErrorHandler",value:function(t){console.log(t),4===t.readyState?jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:t.status,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1}):0===t.readyState?jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:jupiterx_cp_textdomain.error_in_network_please_check_your_connection_and_try_again,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1}):jupiterx_modal({title:jupiterx_cp_textdomain.something_went_wrong,text:jupiterx_cp_textdomain.something_wierd_happened_please_try_again,type:"error",showCancelButton:!1,showConfirmButton:!0,showLearnmoreButton:!1})}}]),h);function h(){_classCallCheck(this,h),this.$element=d(".jupiterx-cp-plugins-list"),this.$element.length&&(this.$header=this.$element.find(".jupiterx-cp-plugins-header"),this.$alertOptional=this.$element.find(".jupiterx-cp-plugins-alert-optional"),this.$actionsRequired=this.$element.find(".jupiterx-cp-plugins-actions-required"),this.$plugins=this.$element.find("#js__jupiterx-plugins"),this.$pluginsRequired=this.$element.find(".jupiterx-cp-plugins-required"),this.$pluginsOptional=this.$element.find(".jupiterx-cp-plugins-optional"),this.isMultisite=document.body.classList.contains("multisite"),this.plugins=[],this.limit=0,this.events(),this.init(),this.isPlugin2()&&this.$plugins.removeClass("d-flex").addClass("d-none"))}var v=(_createClass(j,[{key:"init",value:function(){var t=window.location.hash,e=t.substring(1,t.length),n=jupiterxControlPanel.initialSection;t&&e&&e!==n?this.goTo(e):n&&(this.sectionEvents(n),this.commonEvents())}},{key:"events",value:function(){var i=this;i.element.on("click",".jupiterx-cp-sidebar-link",function(t){t.preventDefault();var e=d(this).attr("href"),n=e.substring(1,e.length);window.location.hash=e,i.goTo(n)})}},{key:"goTo",value:function(e){var n=this,i=n.sidebar,o=n.panes;o.addClass("loading-pane"),d.ajax({type:"POST",url:_wpUtilSettings.ajax.url,data:{action:"jupiterx_cp_load_pane_action",slug:e},success:function(t){o.empty(),o.append(t.data),o.removeClass("loading-pane"),i.find(".jupiterx-is-active").removeClass("jupiterx-is-active"),i.find("[href='#"+e+"']").parent().addClass("jupiterx-is-active"),n.sectionEvents(e),n.commonEvents()}})}},{key:"sectionEvents",value:function(t){var e=this.sections;e[t]&&new e[t]}},{key:"commonEvents",value:function(){var i=this;d(".jupiterx-cpanel-link").on("click",function(t){t.preventDefault();var e=d(this).attr("href"),n=e.substring(1,e.length);window.location.hash=e,i.goTo(n)}),d(".jupiterx-pro-badge").tooltip({title:jupiterx_cp_textdomain.pro_badge_tooltip_title,trigger:"hover",container:".jupiterx-wrap",template:'\n          <div class="tooltip jupiterx-pro-badge-tooltip" role="tooltip">\n            <div class="arrow"></div>\n            <div class="tooltip-inner"></div>\n          </div>\n        '}),d('[data-toggle="popover"]').click(function(t){t.preventDefault()}),d('[data-toggle="popover"]').popover({trigger:"hover",container:".jupiterx.jupiterx-cp-wrap"}),d('[data-toggle="tooltip"]').tooltip()}}]),j);function j(t){var e=t.node;_classCallCheck(this,j),this.element=d(e),this.sidebar=this.element.find(".jupiterx-cp-sidebar"),this.panes=this.element.find(".jupiterx-cp-panes"),this.sections={home:n,settings:a,"install-templates":i,"system-status":r,"update-theme":l,"image-sizes":c,"export-import":x,"install-plugins":g},this.init(),this.events()}d(".jupiterx-cp-wrap").each(function(t,e){new v({node:e})})}(jQuery,jupiterx);