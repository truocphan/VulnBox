"use strict"
jQuery(function($) {

    /*-------------------------------------------------------
        
        ------ Its Include Following Function -----

        1- Upload SVG Files Via WP Media
        
    --------------------------------------------------------*/


    /**
        1- Upload SVG Files Via WP Media
    **/
    $(document).on('click', '.ppom-svg-uploader-js', function(e) {
        e.preventDefault();

        var main_wrapper = $(this).closest('.ppom-slider');
        var field_index = main_wrapper.find('.ppom-fields-actions').attr('data-field-no');

        var button = $(this),
            custom_uploader = wp.media({
                title: 'Insert SVG File',
                library: {
                    type: 'image/svg+xml'
                },
                button: {
                    text: 'Use this SVG'
                },
                multiple: false
            }).on('select', function() {
                var attachment = custom_uploader.state().get('selection').first().toJSON();
                var fileurl = attachment.url;
                var fileid = attachment.id;
                var filename = attachment.filename;

                let html = '';
                html += '<span>' + filename + '</span>';
                html += '<input type="hidden" name="ppom[' + field_index + '][svg_uploader][url]" class="form-control" data-metatype="url" value="' + fileurl + '">';
                html += '<input type="hidden" name="ppom[' + field_index + '][svg_uploader][id]" class="form-control" data-metatype="id" value="' + fileid + '">';
                html += '<input type="hidden" name="ppom[' + field_index + '][svg_uploader][filename]" class="form-control" data-metatype="filename" value="' + filename + '">';
                $('.ppom-svg-uploader-html').html(html);

            })
            .open();
    });

});
